# Maintainer: Amir Mohammadi <183.amir@gmail.com>

pkgname=pgi-docs-devhelp-git
pkgver=r1.8b7cbc4
pkgrel=1
pkgdesc="Devhelp packages generated by pgi-docgen "
arch=('any')
url="https://github.com/lazka/pgi-docs-devhelp"
license=('unknown')
depends=('devhelp')
makedepends=('git')
provides=('pgi-docs-devhelp')
conflicts=('pgi-docs-devhelp')
source=(git+https://github.com/lazka/pgi-docs-devhelp.git)
md5sums=('SKIP')

_gitname=pgi-docs-devhelp

pkgver() {
  cd "$_gitname"
  ( set -o pipefail
    git describe --long | sed -r 's/([^-]*-g)/r\1/;s/-/./g' ||
    printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
  )
}

prepare() {
  cd "$srcdir/$_gitname"
  # removing the github readme file
  rm README.rst
}

package() {
  install -d "$pkgdir/usr/share/devhelp/books/"
  cd "$srcdir/$_gitname"
  cp -R * "$pkgdir/usr/share/devhelp/books/"
}

# vim:set ts=2 sw=2 et:
